"""
Does Fourier Transform
"""

import numpy as np
from scipy import fft


def fourier(signal):
    '''
        signal passed here is a dataframe with columns ['date', 'cpu'] from a single machine.
    '''

    # Plotting power in the frequency domain
    fft_output = fft.fft(signal.cpu.values)
    power = np.abs(fft_output)
    freq = fft.fftfreq(len(signal))
    
    mask = freq >= 0
    freq = freq[mask]
    power = power[mask]
    

    return freq, power

def time_freq_dataset(signal_matrix):
    '''
        given a list of time series dataframes
        applies fourier and 
        returns list of frequencies and list of amplitudes
    '''
    #if df was treated and padded, freq spectrum will be tha same to all hosts considered

    #amplitude matrix array of shape = (n_machines,size_freq_spectrum)

    amplitude_matrix = []
    for s in signal_matrix:
        freq, amp = fourier(s)
        amplitude_matrix.append(amp)

    return freq, np.array(amplitude_matrix)
        
